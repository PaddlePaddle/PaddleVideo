{
    "summary": "The FootballAction model in PaddleVideo employs PP-TSM, BMN, and Attention LSTM for feature extraction and classification/regression. The code updates the recognizer2d.py file, exports PP-TSM inference models, creates datasets, and predicts BMN proposal information. The Attention LSTM model is trained with improvements, resulting in accuracy and F1-score enhancements.",
    "details": [
        {
            "comment": "This is a README for the FootballAction model in PaddleVideo, introducing a soccer action detection algorithm. It consists of sections on model introduction, environment preparation, data preparation (including dataset details), quick experience, advanced usage, references, and installation instructions. The model uses PP-TSM, BMN, and AttentionLSTM for feature extraction, proposal extraction, and action classification/regression from image and audio modalities. The dataset is derived from the 2016 European Cup, with 49 videos in total (44 training, 5 validation).",
            "location": "\"/media/root/Prima/works/PaddleVideo/docs/src/applications/FootballAction/README.md\":0-53",
            "content": "# \u8db3\u7403\u52a8\u4f5c\u68c0\u6d4b\u6a21\u578b\n## \u5185\u5bb9\n- [1. \u6a21\u578b\u7b80\u4ecb](#1-\u6a21\u578b\u7b80\u4ecb)\n- [2. \u73af\u5883\u51c6\u5907](#2-\u73af\u5883\u51c6\u5907)\n- [3. \u6570\u636e\u51c6\u5907](#3-\u6570\u636e\u51c6\u5907)\n    - [3.1 \u6570\u636e\u96c6\u7b80\u4ecb](#31-\u6570\u636e\u96c6\u7b80\u4ecb)\n    - [3.2 \u6570\u636e\u96c6\u4e0b\u8f7d](#32-\u6570\u636e\u96c6\u4e0b\u8f7d)\n    - [3.3 \u6570\u636e\u9884\u5904\u7406](#33-\u6570\u636e\u9884\u5904\u7406)\n- [4. \u5feb\u901f\u4f53\u9a8c](#4-\u5feb\u901f\u4f53\u9a8c)\n- [5. \u8fdb\u9636\u4f7f\u7528](#5-\u8fdb\u9636\u4f7f\u7528)\n    - [5.1 \u6a21\u578b\u8bad\u7ec3](#51-\u6a21\u578b\u8bad\u7ec3)\n    - [5.2 \u6a21\u578b\u63a8\u7406](#52-\u6a21\u578b\u63a8\u7406)\n    - [5.3 \u6a21\u578b\u8bc4\u4f30](#53-\u6a21\u578b\u8bc4\u4f30)\n    - [5.4 \u6a21\u578b\u4f18\u5316](#54-\u6a21\u578b\u4f18\u5316)\n    - [5.5 \u6a21\u578b\u90e8\u7f72](#55-\u6a21\u578b\u90e8\u7f72)\n- [6. \u53c2\u8003\u8bba\u6587](#6-\u53c2\u8003\u8bba\u6587)\n<a name=\"\u6a21\u578b\u7b80\u4ecb\"></a>\n## 1. \u6a21\u578b\u7b80\u4ecb\nFootballAction\u662f\u57fa\u4e8ePaddleVideo\u5b9e\u73b0\u7684\u8db3\u7403\u52a8\u4f5c\u68c0\u6d4b\u7b97\u6cd5\uff0c\u7528\u4e8e\u4ece\u8db3\u7403\u6bd4\u8d5b\u89c6\u9891\u4e2d\u5b9a\u4f4d\u51fa\u7cbe\u5f69\u52a8\u4f5c\u7247\u6bb5\u53d1\u751f\u7684\u8d77\u6b62\u65f6\u95f4\u548c\u5bf9\u5e94\u7684\u52a8\u4f5c\u7c7b\u522b\u3002\u53ef\u4ee5\u5b9a\u4f4d\u7684\u8db3\u7403\u52a8\u4f5c\u7c7b\u578b\u5305\u62ec8\u79cd\uff0c\u5206\u522b\u4e3a\uff1a\n```txt\n\u80cc\u666f\u3001\u8fdb\u7403\u3001\u89d2\u7403\u3001\u4efb\u610f\u7403\u3001\u9ec4\u724c\u3001\u7ea2\u724c\u3001\u6362\u4eba\u3001\u754c\u5916\u7403\n```\n\u6211\u4eec\u63d0\u51fa\u7684\u65b9\u6848\u7ed3\u5408PP-TSM\u3001BMN\u548cAttentionLSTM\u4e09\u4e2a\u6a21\u578b\uff0c\u56fe\u50cf\u548c\u97f3\u9891\u4e24\u79cd\u6a21\u6001\u8fdb\u884c\u52a8\u4f5c\u68c0\u6d4b\uff0c\u7b97\u6cd5\u6574\u4f53\u6d41\u7a0b\u5171\u5206\u4e3a\u4ee5\u4e0b\u4e09\u6b65\uff1a\n - \u7279\u5f81\u62bd\u53d6\n    - \u56fe\u50cf\u7279\u6027\uff1aPP-TSM\n    - \u97f3\u9891\u7279\u5f81\uff1aVGGish\n - proposal\u63d0\u53d6\uff1aBMN\n - \u52a8\u4f5c\u5206\u7c7b + \u56de\u5f52\uff1aAttentionLSTM\nAIStudio\u9879\u76ee\uff1a [\u57fa\u4e8ePP-TSM+BMN+AttentionLSTM\u5b9e\u73b0\u8db3\u7403\u7cbe\u5f69\u65f6\u523b\u526a\u8f91](https://aistudio.baidu.com/aistudio/projectdetail/3473391?channelType=0&channel=0)\n<a name=\"\u73af\u5883\u51c6\u5907\"></a>\n## 2. \u73af\u5883\u51c6\u5907\n- PaddleVideo\u6a21\u578b\u5e93\u4f9d\u8d56\u5b89\u88c5\u8bf7\u53c2\u8003 [\u5b89\u88c5\u8bf4\u660e](../../docs/zh-CN/install.md)\n<a name=\"\u6570\u636e\u51c6\u5907\"></a>\n## 3. \u6570\u636e\u51c6\u5907\n<a name=\"\u6570\u636e\u96c6\u7b80\u4ecb\"></a>\n### 3.1 \u6570\u636e\u96c6\u7b80\u4ecb\n\u6570\u636e\u96c6\u6765\u81ea\u6b27\u6d32\u676f2016\uff0c\u517149\u4e2a\u8db3\u7403\u89c6\u9891\uff0c\u5176\u4e2d\u8bad\u7ec3\u96c644\u4e2a\uff0c\u9a8c\u8bc1\u96c65\u4e2a\u3002\n- \u6570\u636e\u96c6label\u683c\u5f0f\n```\n{\n    \"0\": \"\u80cc\u666f\","
        },
        {
            "comment": "This code defines a dictionary where each key corresponds to an action in the football game, such as \"\u8fdb\u7403\" or \"\u89d2\u7403\". The dataset file contains these labeled examples of actions for training and validation purposes. The data preprocessing step involves handling these labels, creating a JSON format file containing frames per second (fps) and ground truth (gts) data with respective video URLs, total frames, and action information including label IDs, names, start and end frame indices. It also mentions that the dataset can be downloaded using a provided script, and that the code structure is organized in a specific way.",
            "location": "\"/media/root/Prima/works/PaddleVideo/docs/src/applications/FootballAction/README.md\":54-117",
            "content": "    \"1\": \"\u8fdb\u7403\",\n    \"2\": \"\u89d2\u7403\",\n    \"3\": \"\u4efb\u610f\u7403\",\n    \"4\": \"\u9ec4\u724c\",\n    \"5\": \"\u7ea2\u724c\",\n    \"6\": \"\u6362\u4eba\",\n    \"7\": \"\u754c\u5916\u7403\",\n}\n```\n- \u6570\u636e\u96c6\u6807\u6ce8\u6587\u4ef6:\n```txt\ndatasets/EuroCup2016/label_cls8_train.json\ndatasets/EuroCup2016/label_cls8_val.json\n```\n- \u6570\u636e\u96c6gts\u5904\u7406, \u5c06\u539f\u59cb\u6807\u6ce8\u6570\u636e\u5904\u7406\u6210\u5982\u4e0bjson\u683c\u5f0f\n```\n{\n    'fps': 5,\n    'gts': [\n        {\n            'url': 'xxx.mp4',\n            'total_frames': 6341,\n            'actions': [\n                {\n                    \"label_ids\": [7],\n                    \"label_names\": [\"\u754c\u5916\u7403\"],\n                    \"start_id\": 395,\n                    \"end_id\": 399\n                },\n                ...\n            ]\n        },\n        ...\n    ]\n}\n```\n<a name=\"\u6570\u636e\u96c6\u4e0b\u8f7d\"></a>\n### 3.2 \u6570\u636e\u96c6\u4e0b\u8f7d\n\u6570\u636e\u96c6\u4e0b\u8f7d\u94fe\u63a5: [dataset_url.list](./datasets/EuroCup2016/dataset_url.list)\n\u53ef\u4f7f\u7528\u5982\u4e0b\u811a\u672c\u4e0b\u8f7d\uff1a\n```\ncd datasets/EuroCup2016 && sh download_dataset.sh\n```\n<a name=\"\u6570\u636e\u9884\u5904\u7406\"></a>\n### 3.3 \u6570\u636e\u9884\u5904\u7406\n- \u6570\u636e\u96c6\u62bd\u5e27, \u7531mp4, \u5f97\u5230frames\u548cpcm, \u8fd9\u91cc\u9700\u8981\u6dfb\u52a0ffmpeg\u73af\u5883\n```\ncd datasets/script && python get_frames_pcm.py\n```\n\u7ecf\u8fc7\u4ee5\u4e0a\u6b65\u9aa4\uff0c\u5f97\u5230\u7684\u4ee3\u7801\u7ed3\u6784\u5982\u4e0b\u6240\u793a\uff1a\n```\n|-- FootballAction\n   |--  checkpoints                # \u6a21\u578b\u5b58\u653e\u8def\u5f84\n   |--  datasets                   # \u6570\u636e\u96c6\u548c\u6570\u636e\u5904\u7406\u811a\u672c"
        },
        {
            "comment": "This directory contains data and scripts related to the FootballAction dataset. It includes original MP4 videos, their image frames, audio PCM files, URL lists, and JSON files for ground truth labels and classifications. There are also separate folders for scripting data processing, feature extraction, model training (LSTM), and proposal-based object detection (PPTSM and BDN). The configs folder contains the configuration files needed for these training scripts.",
            "location": "\"/media/root/Prima/works/PaddleVideo/docs/src/applications/FootballAction/README.md\":118-140",
            "content": "        |--  EuroCup2016           # \u6570\u636e\u5b58\u653e\u8def\u5f84\n            |--  feature_bmn       # bmn\u63d0\u53d6\u5230\u7684proposal\n            |--  features          # image\u548caudio\u7279\u5f81, image fps=5, audio \u6bcf\u79d2(1024)\n            |--  input_for_bmn     # bmn\u8bad\u7ec3\u7684\u8f93\u5165\u6570\u636e\uff0cwidows=40\n            |--  input_for_lstm    # lstm\u8bad\u7ec3\u7684\u8f93\u5165\u6570\u636e\n            |--  input_for_pptsm    # pptsm\u8bad\u7ec3\u7684\u6570\u636e\u6570\u636e\n            |--  mp4               # \u539f\u59cb\u89c6\u9891.mp4\n            |--  frames            # \u56fe\u50cf\u5e27, fps=5, '.jpg'\u683c\u5f0f\n            |--  pcm               # \u97f3\u9891pcm, \u97f3\u9891\u91c7\u6837\u738716000\uff0c\u91c7\u7528\u901a\u9053\u65701\n            |--  url.list          # \u89c6\u9891\u5217\u8868\n            |--  url_val.list          # \u89c6\u9891\u5217\u8868\n            |--  label_cls8_train.json  # \u8bad\u7ec3\u96c6\u539f\u59cbgts\n            |--  label_cls8_val.json    # \u9a8c\u8bc1\u96c6\u539f\u59cbgts\n            |--  label.json        # \u52a8\u4f5clabel\n        |--  script                # \u6570\u636e\u96c6\u5904\u7406\u811a\u672c\n    |--  predict                   # \u6a21\u578b\u9884\u6d4b\u4ee3\u7801\n    |--  extractor                 # \u7279\u5f81\u63d0\u53d6\u811a\u672c\n    |--  train_lstm                # lstm\u8bad\u7ec3\u4ee3\u7801\n    |--  train_proposal            # pptsm\u3001bmn\u8bad\u7ec3\u4ee3\u7801\n        |--  configs               # pptsm\u3001bmn\u914d\u7f6e\u6587\u4ef6\n```\n<a name=\"\u5feb\u901f\u4f53\u9a8c\"></a>"
        },
        {
            "comment": "This code explains the steps to download a pre-trained model, run prediction, and perform advanced usage including training PP-TSM for the FootballAction application in PaddleVideo. It requires following specific commands and using provided scripts.",
            "location": "\"/media/root/Prima/works/PaddleVideo/docs/src/applications/FootballAction/README.md\":141-200",
            "content": "## 4. \u5feb\u901f\u4f53\u9a8c\n\u9996\u5148\uff0c\u901a\u8fc7\u4ee5\u4e0b\u547d\u4ee4\uff0c\u4e0b\u8f7d\u8bad\u7ec3\u597d\u7684\u6a21\u578b\u6587\u4ef6\uff1a\n```bash\ncd checkpoints\nsh  download.sh\n```\n\u8fd0\u884c\u9884\u6d4b\u4ee3\u7801\uff1a\n```\ncd ${FootballAction_root}/predict && python predict.py\n```\n\u4ea7\u51fa\u6587\u4ef6\uff1aresults.json\n<a name=\"\u8fdb\u9636\u4f7f\u7528\"></a>\n## 5. \u8fdb\u9636\u4f7f\u7528\n<a name=\"\u6a21\u578b\u8bad\u7ec3\"></a>\n### 5.1 \u6a21\u578b\u8bad\u7ec3\n\u91c7\u6837\u65b9\u5f0f\uff1a\n- image \u91c7\u6837\u9891\u7387fps=5\uff0c\u5982\u679c\u6709\u4e9b\u52a8\u4f5c\u65f6\u95f4\u8f83\u77ed\uff0c\u53ef\u4ee5\u9002\u5f53\u63d0\u9ad8\u91c7\u6837\u9891\u7387\n- BMN windows=200\uff0c\u537340s\uff0c\u6240\u4ee5\u6d4b\u8bd5\u81ea\u5df1\u7684\u6570\u636e\u65f6\uff0c\u89c6\u9891\u65f6\u957f\u9700\u5927\u4e8e40s\n\u8bf7\u5148\u53c2\u8003[\u4f7f\u7528\u8bf4\u660e](../../docs/zh-CN/usage.md)\u4e86\u89e3PaddleVideo\u6a21\u578b\u5e93\u7684\u4f7f\u7528\u3002\n#### step1 PP-TSM\u8bad\u7ec3\nPP-TSM\u6a21\u578b\u4f7f\u7528\u6587\u6863\u53c2\u8003[PP-TSM](../../docs/zh-CN/model_zoo/recognition/pp-tsm.md)\n##### step1.1  PP-TSM \u8bad\u7ec3\u6570\u636e\u5904\u7406\n\u4f7f\u7528\u5982\u4e0b\u547d\u4ee4\u7ed3\u5408frames\u548cgts\u751f\u6210\u8bad\u7ec3\u6240\u9700\u8981\u7684\u6b63\u8d1f\u6837\u672c:\n```bash\ncd datasets/script && python get_instance_for_pptsm.py\n```\n\u5b8c\u6210\u8be5\u6b65\u9aa4\u540e\uff0c\u6570\u636e\u5b58\u50a8\u4f4d\u7f6e\n```\n   |--  datasets                   # \u6570\u636e\u96c6\u548c\u6570\u636e\u5904\u7406\u811a\u672c\n        |--  EuroCup2016           # \u6570\u636e\u5b58\u653e\u8def\u5f84\n            |--  input_for_pptsm   # pptsm\u8bad\u7ec3\u7684\u6570\u636e\n```\n\u6587\u4ef6\u6309\u7167\u5982\u4e0b\u683c\u5f0f\u547d\u540d\uff1a\n```\n'{}_{}_{}_{}'.format(video_basename, start_id, end_id, label)\n```\n##### step1.2 PP-TSM\u6a21\u578b\u8bad\u7ec3\n\u8bad\u7ec3\u542f\u52a8\u547d\u4ee4\u5982\u4e0b\uff1a\n```bash\ncd ${FootballAction_root}\ncd ../..  #\u8fdb\u5165PaddleVideo\u76ee\u5f55\u4e0b\npython -B -m paddle.distributed.launch \\\n    --gpus=\"0,1,2,3\" \\\n    --log_dir=./football/logs_pptsm \\\n    main.py  \\"
        },
        {
            "comment": "This code is updating the `recognizer2d.py` file in PaddleVideo, modifying the `__init__` and `infer_step` functions. Then it executes a command to export the PP-TSM inference model using the provided configuration file and best model parameters from previous training.",
            "location": "\"/media/root/Prima/works/PaddleVideo/docs/src/applications/FootballAction/README.md\":201-229",
            "content": "    --validate \\\n    -c applications/FootballAction/train_proposal/configs/pptsm_football_v2.0.yaml  \\\n    -o output_dir=./football/pptsm\n```\n\u6211\u4eec\u4e5f\u63d0\u4f9b\u4e86\u8bad\u7ec3\u597d\u7684PP-TSM\u6a21\u578b\uff0c\u4e0b\u8f7d\u94fe\u63a5\u5df2\u5728\u5feb\u901f\u4f53\u9a8c\u7ae0\u8282\u4e2d\u7ed9\u51fa\u3002\n##### step1.3 \u5bfc\u51faPP-TSM\u63a8\u7406\u6a21\u578b\n\u5728\u8f6c\u4e3a\u9884\u6d4b\u6a21\u5f0f\u524d\uff0c\u9700\u8981\u4fee\u6539 `PaddleVideo/paddlevideo/modeling/framework/recognizers/recognizer2d.py` \u6587\u4ef6\uff0c\u5c06 init \u548c infer_step \u51fd\u6570\u5206\u522b\u66f4\u65b0\u4e3a\u5982\u4e0b\u4ee3\u7801\uff1a\n```python\n    def __init__(self, backbone=None, head=None):\n        super().__init__(backbone=backbone, head=head)\n        self.avgpool2d = paddle.nn.AdaptiveAvgPool2D((1, 1), data_format='NCHW')\n    def infer_step(self, data_batch):\n        \"\"\"Define how the model is going to test, from input to output.\"\"\"\n        imgs = data_batch[0]\n        imgs = paddle.reshape_(imgs, [-1] + list(imgs.shape[2:]))\n        feature = self.backbone(imgs)\n        feat = self.avgpool2d(feature)\n        return feat\n```\n\u518d\u6267\u884c\u5982\u4e0b\u547d\u4ee4\uff1a\n```bash\ncd ${PaddleVideo_root}\npython tools/export_model.py -c applications/FootballAction/train_proposal/configs/pptsm_football_v2.0.yaml \\\n                             -p ./football/pptsm/ppTSM_best.pdparams \\"
        },
        {
            "comment": "In this code snippet, we are replacing a line of code in `pptsm_infer.py` to change the output tensor from the second to the first output name. This is followed by commands to extract image and audio features using the modified code, which are stored in the \"features\" folder within the respective dataset. These features will be used in the training of a BMN model.",
            "location": "\"/media/root/Prima/works/PaddleVideo/docs/src/applications/FootballAction/README.md\":230-274",
            "content": "                             -o ./football/inference_model\n```\n#####  step1.4  \u57fa\u4e8ePP-TSM\u7684\u89c6\u9891\u7279\u5f81\u63d0\u53d6\n\u5c06 `PaddleVideo/applications/FootballAction/predict/action_detect/models/pptsm_infer.py` \u6587\u4ef6\u4e2d41\u884c\u7684\n```python\nself.output_tensor = self.predictor.get_output_handle(output_names[1])\n```\n\u66ff\u6362\u4e3a\n```python\nself.output_tensor = self.predictor.get_output_handle(output_names[0])\n```\n\u4f7f\u7528\u5982\u4e0b\u547d\u4ee4\u8fdb\u884cimage\u548caudio\u7279\u5f81\u7684\u63d0\u53d6\uff0c\u9ed8\u8ba4\u4f7f\u7528\u4e0b\u8f7d\u7684\u6a21\u578b\u8fdb\u884c\u7279\u5f81\u63d0\u53d6\uff0c\u5982\u679c\u4f7f\u7528\u81ea\u5df1\u6570\u636e\u8bad\u7ec3\u7684\u6a21\u578b\uff0c\u8bf7\u6ce8\u610f\u4fee\u6539\u914d\u7f6e\u6587\u4ef6\u4e2d\u6a21\u578b\u7684\u6587\u4ef6\u8def\u5f84:\n```bash\ncd ${FootballAcation}\ncd extractor && python extract_feat.py\n```\n\u5b8c\u6210\u8be5\u6b65\u9aa4\u540e\uff0c\u6570\u636e\u5b58\u50a8\u4f4d\u7f6e\n```\n   |--  datasets                   # \u8bad\u7ec3\u6570\u636e\u96c6\u548c\u5904\u7406\u811a\u672c\n        |--  EuroCup2016            # \u6570\u636e\u96c6\n            |--  features          # \u89c6\u9891\u7684\u56fe\u50cf+\u97f3\u9891\u7279\u5f81\n```\n\u63a8\u7406\u7279\u5f81\u4ee5pkl\u6587\u4ef6\u4fdd\u5b58\uff0c\u683c\u5f0f\u5982\u4e0b\uff1a\n```txt\n# \u7279\u5f81\u7ef4\u5ea6, image(2048) + audio(1024)\nvideo_features = {'image_feature': np_image_features,\n                  'audio_feature': np_audio_features}\n```\n\u6b64\u7279\u5f81\u63a5\u4e0b\u6765\u4f1a\u7528\u4e8eBMN\u6a21\u578b\u7684\u8bad\u7ec3\u3002\n#### step2 BMN\u8bad\u7ec3\nBMN\u6a21\u578b\u4f7f\u7528\u6587\u6863\u53c2\u8003[BMN](../../docs/zh-CN/model_zoo/localization/bmn.md)\n##### step2.1 BMN\u8bad\u7ec3\u6570\u636e\u5904\u7406\n\u4f7f\u7528\u5982\u4e0b\u547d\u4ee4\u5f97\u5230BMN\u8bad\u7ec3\u6240\u9700\u8981\u7684\u6570\u636e\u96c6\uff0c\u9ed8\u8ba4\u4f7f\u7528windows=40\uff0c\u6839\u636egts\u548c\u7279\u5f81\u5f97\u5230\u8bad\u7ec3\u6240\u9700\u7684proposal\uff1a\n```bash"
        },
        {
            "comment": "This code changes the directory to \"FootballAction/datasets/script\" and runs a Python script named get_instance_for_bmn.py, which creates a dataset for BMN (Bounding Box Regression) model training. The resulting data is stored in the datasets folder with the instance information saved as JSON files within the input_for_bmn directory.",
            "location": "\"/media/root/Prima/works/PaddleVideo/docs/src/applications/FootballAction/README.md\":275-319",
            "content": "cd FootballAction/datasets/script && python get_instance_for_bmn.py\n```\n\u5b8c\u6210\u8be5\u6b65\u9aa4\u540e\uff0c\u6570\u636e\u5b58\u50a8\u4f4d\u7f6e\n```\n   |--  datasets                   # \u8bad\u7ec3\u6570\u636e\u96c6\u548c\u5904\u7406\u811a\u672c\n        |--  EuroCup2016            # \u6570\u636e\u96c6\n            |--  input_for_bmn     # bmn\u8bad\u7ec3\u7684proposal\n                |--  feature\n                |--  label.json  \n```\n\u7279\u5f81\u6587\u4ef6\u4fdd\u5b58\u5728`label.json`\u6587\u4ef6\u4e2d\uff0c\u6570\u636e\u683c\u5f0f\u5982\u4e0b\uff1a\n```txt\n{\n    \"719b0a4bcb1f461eabb152298406b861_753_793\": {\n        \"duration_second\": 40.0,\n        \"duration_frame\": 200,\n        \"feature_frame\": 200,\n        \"subset\": \"train\",\n        \"annotations\": [\n            {\n                \"segment\": [\n                    15.0,\n                    22.0\n                ],\n                \"label\": \"3.0\",\n                \"label_name\": \"\u4efb\u610f\u7403\"\n            }\n        ]\n    },\n    ...\n}\n```\n##### step2.2  BMN\u6a21\u578b\u8bad\u7ec3\n\u8bad\u7ec3\u542f\u52a8\u547d\u4ee4\u5982\u4e0b\uff1a\n```bash\npython -B -m paddle.distributed.launch \\\n     --gpus=\"0,1\" \\\n     --log_dir=./football/logs_bmn \\\n     main.py  \\\n     --validate \\\n     -c applications/FootballAction/train_proposal/configs/bmn_football_v2.0.yaml \\\n     -o output_dir=./football/bmn"
        },
        {
            "comment": "Step 2.3: Export BMN inference model with command `python tools/export_model.py -c applications/FootballAction/train_proposal/configs/bmn_football_v2.0.yaml -p ./football/bmn/BMN_epoch_00016.pdparams -o ./football/inference_model`.\nStep 2.4: Use command `cd extractor && python extract_bmn.py` to predict BMN proposal information.",
            "location": "\"/media/root/Prima/works/PaddleVideo/docs/src/applications/FootballAction/README.md\":320-361",
            "content": "```\n\u6211\u4eec\u4e5f\u63d0\u4f9b\u4e86\u8bad\u7ec3\u597d\u7684BMN\u6a21\u578b\uff0c\u4e0b\u8f7d\u94fe\u63a5\u5df2\u5728\u5feb\u901f\u4f53\u9a8c\u7ae0\u8282\u4e2d\u7ed9\u51fa\u3002\n##### step2.3 \u5bfc\u51faBMN\u63a8\u7406\u6a21\u578b\n\u6a21\u578b\u5bfc\u51fa\u547d\u4ee4\u5982\u4e0b:\n```bash\npython tools/export_model.py -c applications/FootballAction/train_proposal/configs/bmn_football_v2.0.yaml \\\n                              -p ./football/bmn/BMN_epoch_00016.pdparams \\\n                               -o ./football/inference_model\n```\n##### step2.4  BMN\u6a21\u578b\u9884\u6d4b\n\u4f7f\u7528\u5982\u4e0b\u547d\u4ee4\u8fdb\u884c\u9884\u6d4b\uff0c\u5f97\u5230\u52a8\u4f5cproposal\u4fe1\u606f\uff1a start_id, end_id, score\u3002\u5982\u679c\u4f7f\u7528\u81ea\u5df1\u6570\u636e\u8bad\u7ec3\u7684\u6a21\u578b\uff0c\u8bf7\u6ce8\u610f\u4fee\u6539\u914d\u7f6e\u6587\u4ef6\u4e2d\u6a21\u578b\u7684\u6587\u4ef6\u8def\u5f84:\n```\ncd extractor && python extract_bmn.py\n```\n\u5b8c\u6210\u8be5\u6b65\u9aa4\u540e\uff0c\u6570\u636e\u5b58\u50a8\u4f4d\u7f6e\n```\n   |--  datasets                   # \u8bad\u7ec3\u6570\u636e\u96c6\u548c\u5904\u7406\u811a\u672c\n        |--  EuroCup2016            # \u6570\u636e\u96c6\n            |--  feature_bmn\n                 |--  prop.json    # bmn \u9884\u6d4b\u7ed3\u679c\n```\n\u9884\u6d4b\u7ed3\u679c\u6570\u636e\u683c\u5f0f\u5982\u4e0b\uff1a\n```txt\n[\n    {\n        \"video_name\": \"c9516c903de3416c97dae91a59e968d7\",\n        \"num_proposal\": 5534,\n        \"bmn_results\": [\n            {\n                \"start\": 7850.0,\n                \"end\": 7873.0,\n                \"score\": 0.77194699622342\n            },\n            {\n                \"start\": 4400.0,\n                \"end\": 4443.0,\n                \"score\": 0.7663803287641536"
        },
        {
            "comment": "This code is part of the Attention LSTM model training process in the FootballAction application. It mentions a few improvements made to the original AttentionLSTM model, such as using different hidden sizes for different modal features and adding a regression branch for IOU. The code also discusses processing training data for LSTM training and provides an example of the label_info.json format.",
            "location": "\"/media/root/Prima/works/PaddleVideo/docs/src/applications/FootballAction/README.md\":362-407",
            "content": "            },\n            ...\n        ]\n    },\n    ...\n]\n```\n#### step3 LSTM\u8bad\u7ec3\nAttentionLSTM\u6a21\u578b\u4f7f\u7528\u6587\u6863\u53c2\u8003[AttentionLSTM](../../docs/zh-CN/model_zoo/localization/bmn.md)\uff0c\u6b64\u5904\u6211\u4eec\u5bf9\u539f\u59cb\u5bf9AttentionLSTM\u6a21\u578b\u8fdb\u884c\u4e86\u6539\u8fdb\uff0c\u5305\u62ec\uff1a\n1. \u4e0d\u540c\u6a21\u6001\u7279\u5f81\u5728LSTM\u4e2d\u4f7f\u7528\u4e0d\u540c\u7684hiddne_size\n2. \u52a0\u5165\u4e86\u4e00\u4e2a\u56de\u5f52\u5206\u652f\u7528\u4e8e\u56de\u5f52iou\n3. \u6a21\u578b\u4e2d\u52a0\u5165\u4e86BN\u5c42\u6291\u5236\u8fc7\u62df\u5408\n##### step3.1  LSTM\u8bad\u7ec3\u6570\u636e\u5904\u7406\n\u5c06BMN\u5f97\u5230\u7684proposal\u622a\u65ad\u5e76\u5904\u7406\u6210LSTM\u8bad\u7ec3\u6240\u9700\u6570\u636e\u96c6\u3002\u540c\u7406\uff0c\u6ce8\u610f\u6570\u636e\u96c6\u6587\u4ef6\u4fee\u6539\u8def\u5f84\u3002\n```\ncd datasets/script && python get_instance_for_lstm.py\n```\n\u5b8c\u6210\u8be5\u6b65\u9aa4\u540e\uff0c\u6570\u636e\u5b58\u50a8\u4f4d\u7f6e\n```\n   |--  datasets                    # \u8bad\u7ec3\u6570\u636e\u96c6\u548c\u5904\u7406\u811a\u672c\n        |--  EuroCup2016            # \u6570\u636e\u96c6\n            |--  input_for_lstm     # lstm\u8bad\u7ec3\u7684proposal\n                \u251c\u2500\u2500 feature         # \u7279\u5f81\n                \u251c\u2500\u2500 label_info.json # \u6807\u7b7e\u4fe1\u606f\n                \u251c\u2500\u2500 train.txt       # \u8bad\u7ec3\u6587\u4ef6\u5217\u8868\n                \u2514\u2500\u2500 val.txt         # \u6d4b\u8bd5\u6587\u4ef6\u5217\u8868\n```\n- `label_info.json`\u6570\u636e\u683c\u5f0f\u5982\u4e0b\uff1a\n```\n{\n    \"fps\": 5,\n    \"results\": [\n        {\n            \"url\": \"https://xxx.mp4\",\n            \"mode\": \"train\",        # train or validation\n            \"total_frames\": 6128,\n            \"num_gts\": 93,\n            \"num_proposals\": 5043,\n            \"proposal_actions\": ["
        },
        {
            "comment": "This code snippet represents the structure of a single data sample used in training an LSTM model for action recognition. The data includes image and audio features, frame-level labels, and metrics like IOU (Intersection over Union) and IOA (Intersection over Area). The \"proposal\" field contains start, end, and score values to define the segment of interest. The \"hit_gts\" field provides ground truth information about the labeled action segments within the sample.",
            "location": "\"/media/root/Prima/works/PaddleVideo/docs/src/applications/FootballAction/README.md\":408-440",
            "content": "                {\n                    \"label\": 6,\n                    \"norm_iou\": 0.7575757575757576,\n                    \"norm_ioa\": 0.7575757575757576,\n                    \"norm_start\": -0.32,\n                    \"proposal\": {\n                        \"start\": 5011,\n                        \"end\": 5036,\n                        \"score\": 0.7723643666324231\n                    },\n                    \"hit_gts\": {\n                        \"label_ids\": [\n                            6\n                        ],\n                        \"label_names\": [\n                            \"\u6362\u4eba\"\n                        ],\n                        \"start_id\": 5003,\n                        \"end_id\": 5036\n                    }\n                },\n                ...\n        },\n        ...\n}\n```\n- LSTM\u8bad\u7ec3\u6240\u9700\u8981\u7684feature\u6570\u636e\u683c\u5f0f\u5982\u4e0b:\n```\n{\n    'features': np.array(feature_hit, dtype=np.float32),    # iamge\u548caudio \u7279\u5f81\n    'feature_fps': 5,                                       # fps = 5\n    'label_info': {'norm_iou': 0.5, 'label': 3, ...},       # \u6570\u636e\u683c\u5f0f1\u4e2d\u7684'proposal_actions'"
        },
        {
            "comment": "This code represents the data format for listing necessary files for LSTM training, and provides commands for launching LSTM training, exporting the trained model for inference, running predictions with default or custom models, and evaluating the model's performance.",
            "location": "\"/media/root/Prima/works/PaddleVideo/docs/src/applications/FootballAction/README.md\":441-492",
            "content": "    'video_name': 'c9516c903de3416c97dae91a59e968d7'        # video_name\n}\n```\n- LSTM\u8bad\u7ec3\u6240\u9700\u6587\u4ef6\u5217\u8868\u6570\u636e\u683c\u5f0f\u5982\u4e0b\uff1a\n```\n'{} {}'.format(filename, label)\n```\n##### step3.2  LSTM\u8bad\u7ec3\n\u8bad\u7ec3\u542f\u52a8\u547d\u4ee4\u5982\u4e0b:\n```bash\npython -B -m paddle.distributed.launch \\\n     --gpus=\"0,1,2,3\" \\\n     --log_dir=./football/logs_lstm \\\n     main.py  \\\n     --validate \\\n     -c applications/FootballAction/train_proposal/configs/lstm_football.yaml \\\n     -o output_dir=./football/lstm\n```\n##### step3.3 \u5bfc\u51faLSTM\u63a8\u7406\u6a21\u578b\n\u6a21\u578b\u5bfc\u51fa\u547d\u4ee4\u5982\u4e0b:\n```bash\npython tools/export_model.py -c applications/FootballAction/train_proposal/configs/lstm_football.yaml \\\n                              -p ./football/lstm/AttentionLSTM_best.pdparams  \\\n                               -o ./football/inference_model\n```\n<a name=\"\u6a21\u578b\u63a8\u7406\"></a>\n### 5.2 \u6a21\u578b\u63a8\u7406\n\u8fd0\u884c\u9884\u6d4b\u4ee3\u7801\n```\ncd predict && python predict.py\n```\n- \u9ed8\u8ba4\u4f7f\u7528\u6211\u4eec\u63d0\u4f9b\u7684\u4e8e\u8bad\u7ec3\u6587\u4ef6\u8fdb\u884c\u9884\u6d4b\uff0c\u5982\u4f7f\u7528\u4e2a\u4eba\u8bad\u7ec3\u7684\u6a21\u578b\u6587\u4ef6\uff0c\u8bf7\u5bf9\u5e94\u4fee\u6539[\u914d\u7f6e\u6587\u4ef6](./predict/configs/configs.yaml)\u4e2d\u7684\u53c2\u6570\u8def\u5f84\n- \u4ea7\u51fa\u6587\u4ef6\uff1aresults.json\n<a name=\"\u6a21\u578b\u8bc4\u4f30\"></a>\n### 5.3 \u6a21\u578b\u8bc4\u4f30\n```\n# \u5305\u62ecbmn proposal \u8bc4\u4f30\u548c\u6700\u7ec8action\u8bc4\u4f30\ncd predict && python eval.py results.json\n```\n<a name=\"\u6a21\u578b\u4f18\u5316\"></a>"
        },
        {
            "comment": "The code discusses model optimization, where the base feature model (image) is replaced with PP-TSM, resulting in a 94% accuracy improvement. The audio base feature remains unchanged. This leads to an F1-score increase from 0.57 to 0.82. It also mentions model deployment and provides references for related papers.",
            "location": "\"/media/root/Prima/works/PaddleVideo/docs/src/applications/FootballAction/README.md\":493-512",
            "content": "### 5.4 \u6a21\u578b\u4f18\u5316\n- \u57fa\u7840\u7279\u5f81\u6a21\u578b\uff08\u56fe\u50cf\uff09\u66ff\u6362\u4e3aPP-TSM\uff0c\u51c6\u786e\u7387\u753184%\u63d0\u5347\u523094%\n- \u57fa\u7840\u7279\u5f81\u6a21\u578b\uff08\u97f3\u9891\uff09\u6ca1\u53d8\u52a8\n- \u51c6\u786e\u7387\u63d0\u5347\uff0cprecision\u548crecall\u5747\u6709\u5927\u5e45\u63d0\u5347\uff0cF1-score\u4ece0.57\u63d0\u5347\u52300.82\n<a name=\"\u6a21\u578b\u90e8\u7f72\"></a>\n### 5.5 \u6a21\u578b\u90e8\u7f72\n\u672c\u4ee3\u7801\u89e3\u51b3\u65b9\u6848\u5728\u52a8\u4f5c\u7684\u68c0\u6d4b\u548c\u53ec\u56de\u6307\u6807F1-score=82%\n<a name=\"\u53c2\u8003\u8bba\u6587\"></a>\n### 6. \u53c2\u8003\u8bba\u6587\n- [TSM: Temporal Shift Module for Efficient Video Understanding](https://arxiv.org/pdf/1811.08383.pdf), Ji Lin, Chuang Gan, Song Han\n- [BMN: Boundary-Matching Network for Temporal Action Proposal Generation](https://arxiv.org/abs/1907.09702), Tianwei Lin, Xiao Liu, Xin Li, Errui Ding, Shilei Wen.\n- [Attention Clusters: Purely Attention Based Local Feature Integration for Video Classification](https://arxiv.org/abs/1711.09550), Xiang Long, Chuang Gan, Gerard de Melo, Jiajun Wu, Xiao Liu, Shilei Wen\n- [YouTube-8M: A Large-Scale Video Classification Benchmark](https://arxiv.org/abs/1609.08675), Sami Abu-El-Haija, Nisarg Kothari, Joonseok Lee, Paul Natsev, George Toderici, Balakrishnan Varadarajan, Sudheendra Vijayanarasimhan"
        }
    ]
}